{"id":"twilight_bbs-3f9","title":"[SECURITY][P1] Block path traversal in node:display(name)","description":"Lua API node:display(name) can load display files by name; internal/scripting/api_node.go passes name to loader.Find which joins paths without sanitizing. Reject '..', path separators, absolute paths; clean and verify result remains under allowed display directories.","status":"closed","priority":1,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:54.773832918+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.106583073+01:00","closed_at":"2026-02-13T15:43:46.106583073+01:00","close_reason":"Closed","labels":["display","high","lua","security"]}
{"id":"twilight_bbs-64l","title":"[RELIABILITY][P2] Avoid silent chat message drops","description":"internal/chat/broker.go drops messages when subscriber channel buffer is full (select default). Add logging/metrics and/or backpressure strategy (disconnect slow consumers, larger buffers, or dedicated sender goroutines).","status":"closed","priority":2,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.507458528+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.119546127+01:00","closed_at":"2026-02-13T15:43:46.119546127+01:00","close_reason":"Closed","labels":["chat","medium","reliability"]}
{"id":"twilight_bbs-cpm","title":"[DATA][P3] Define FK ON DELETE behavior in migrations","description":"internal/db/migrations.go defines foreign keys without explicit ON DELETE policy. Add ON DELETE RESTRICT/CASCADE consistent with desired deletion semantics to prevent orphaned records/inconsistencies.","status":"closed","priority":3,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.871869541+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.1273173+01:00","closed_at":"2026-02-13T15:43:46.1273173+01:00","close_reason":"Closed","labels":["data","db","low"]}
{"id":"twilight_bbs-fb8","title":"[RELIABILITY][P2] Don't hold subscriber map lock while broadcasting","description":"internal/chat/broker.go iterates subscribers while holding RLock and sending into channels; can increase contention and complicate safe iteration. Snapshot subscribers under lock then send outside the lock.","status":"closed","priority":2,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.750377318+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.122116644+01:00","closed_at":"2026-02-13T15:43:46.122116644+01:00","close_reason":"Closed","labels":["chat","medium","reliability"]}
{"id":"twilight_bbs-hsf","title":"[RELIABILITY][P2] Add cancellation/deadlines to io.Copy goroutines","description":"internal/door/dosemu.go and internal/menu/engine.go spawn goroutines doing io.Copy without context cancellation or deadlines; can leak on disconnect and exhaust resources. Propagate context, set read/write deadlines, and ensure goroutines exit on session close.","status":"closed","priority":2,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.23617285+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.114077963+01:00","closed_at":"2026-02-13T15:43:46.114077963+01:00","close_reason":"Closed","labels":["concurrency","medium","reliability"]}
{"id":"twilight_bbs-jk0","title":"[SECURITY][P2] Add Lua execution limits (CPU/memory)","description":"internal/scripting/vm.go creates Lua VM without instruction/time/memory limits; buggy/malicious scripts can infinite-loop or OOM (DoS). Add instruction-count hook/timeouts and memory caps around Lua calls.","status":"closed","priority":2,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.382462139+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.117016863+01:00","closed_at":"2026-02-13T15:43:46.117016863+01:00","close_reason":"Closed","labels":["dos","lua","medium","security"]}
{"id":"twilight_bbs-lj3","title":"[SECURITY][P0] Prevent RCE via DoorConfig.Command","description":"Command execution in internal/door/dosemu.go uses DoorConfig.Command without validation/allowlisting. Constrain to allowlisted executables/absolute paths and validate/parse args safely to prevent command injection/RCE.","status":"closed","priority":0,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:54.617446633+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.10357316+01:00","closed_at":"2026-02-13T15:43:46.10357316+01:00","close_reason":"Closed","labels":["critical","door","security"]}
{"id":"twilight_bbs-may","title":"[SECURITY][P3] Tighten SSH hostkey directory permissions","description":"internal/server/ssh.go creates SSH host key directory with 0755; key file is 0600 but directory should be 0700 per best practices. Change MkdirAll mode to 0700.","status":"closed","priority":3,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:56.000590763+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.12990049+01:00","closed_at":"2026-02-13T15:43:46.12990049+01:00","close_reason":"Closed","labels":["low","security","ssh"]}
{"id":"twilight_bbs-p82","title":"[SECURITY][P2] Cap telnet sub-negotiation buffer","description":"internal/server/telnet.go accumulates sub-negotiation payload without a max length; malformed sequences can cause unbounded memory growth. Add maximum buffer size, validate state transitions, and constrain terminal-type string length/charset.","status":"closed","priority":2,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.629733863+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.124649931+01:00","closed_at":"2026-02-13T15:43:46.124649931+01:00","close_reason":"Closed","labels":["dos","medium","security","telnet"]}
{"id":"twilight_bbs-t82","title":"[SECURITY][P1] Escape LIKE wildcards in file search","description":"internal/filearea/repo.go FindByName builds LIKE pattern using user input; while parameterized, '%' and '_' allow unintended broad matches and potential perf abuse. Escape LIKE wildcards and use an explicit ESCAPE clause.","status":"closed","priority":1,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:55.096024231+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.111746606+01:00","closed_at":"2026-02-13T15:43:46.111746606+01:00","close_reason":"Closed","labels":["high","security","sql"]}
{"id":"twilight_bbs-wk2","title":"Fix Lua menu handler timeout","description":"Lua VM enforced a 5s context deadline on CallMenuHandler; interactive menus like assets/menus/login.lua block on node:ask/node:password and would fail with context deadline exceeded. Fix by separating load timeout (5s) from handler timeout (disabled by default).","status":"closed","priority":2,"issue_type":"bug","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T16:04:35.523783093+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T16:04:51.869821567+01:00","closed_at":"2026-02-13T16:04:51.869821567+01:00","close_reason":"Closed"}
{"id":"twilight_bbs-ydx","title":"[SECURITY][P1] Harden SSH transport (rate limiting/auth)","description":"internal/server/ssh.go config uses NoClientAuth: true and accepts all SSH passwords, enabling trivial anonymous connections and DoS/bruteforce at connection layer. Add per-IP rate limiting/backoff and consider real SSH auth (keys/password) or connection gating.","status":"closed","priority":1,"issue_type":"task","owner":"m.madsen@sportradar.com","created_at":"2026-02-13T15:07:54.942465669+01:00","created_by":"Mikael Madsen","updated_at":"2026-02-13T15:43:46.109269268+01:00","closed_at":"2026-02-13T15:43:46.109269268+01:00","close_reason":"Closed","labels":["high","security","ssh"]}
